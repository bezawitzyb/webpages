<body>
  <audio id="bgMusic" loop preload="auto" crossorigin="anonymous">
    <source src="song.mp3" type="audio/mpeg">
  </audio>

  <div class="card">
    <h1 id="title">Mr. Babe‚Ä¶ ‚ù§Ô∏è</h1>
    <p id="question" class="main-p">Will you be my Valentine?</p>

    <div class="buttons" id="buttons">
      <button id="yesBtn">Yes üíñ</button>
      <button id="noBtn">No üôÉ</button>
    </div>

    <div class="congrats" id="congrats">
      üéâ You made the correct choice.
      <div id="audioHint" style="font-size: 0.7rem; font-weight: normal; margin-top: 5px; opacity: 0.8; display:none;">
        (Tap if music doesn't start)
      </div>
    </div>

    <div class="letter" id="letter">
      <h2>My Love,</h2>
      <p>You once messaged me with a confidence that felt almost bold; like you already knew something I hadn‚Äôt figured out yet. And somehow, you were right. From the very beginning, there was a sense of knowing with you; a quiet certainty I never questioned.</p>
      <p>Being with you feels like exhaling. You bring calm where there could be chaos, laughter where there could be heaviness, and steadiness where I sometimes feel unsure. With you, I feel deeply loved for exactly who I am.</p>
      <p>From our early dates and long conversations, to trips that turned into pieces of our story; every memory feels warmer because it has you in it. You have a way of making moments feel meaningful simply by being fully there with me.</p>
      <p>What I admire most about you is not only how you love me in joy, but how intentionally present you are in the difficult moments. You don‚Äôt rush me, you stand beside me, grounded and patient, reminding me through your presence that I am never alone.</p>
      <p>I want you to know how incredibly proud I am of you. Of the way you work relentlessly toward your goals, even on the late nights when no one is watching. Watching you build the life you believe in is one of the most attractive and inspiring things about you.</p>
      <p>I admire your faith deeply; the way you commit to it with intention and consistency. Your fasting, your prayers, your unwavering discipline speak to the strength of your character and the depth of your values.</p>
      <p>Thank you for believing in me, especially while I am changing my career and stepping into the unknown. You made me feel capable when I doubted myself.</p>
      <p>Loving you feels safe and exciting at the same time. I feel chosen, supported, desired, and respected. With you, the future feels intentional; not rushed, but built with care.</p>
      <p>I trust that God is making a way for us, shaping our paths, and preparing a future we will walk into together.</p>
      <p>Thank you for loving me the way you do. Thank you for being my partner, my calm, my strength, and my home.</p>
      <p><strong>Happy Valentine‚Äôs Day ‚ù§Ô∏è</strong></p>
      <p style="text-align:right; padding-bottom: 20px;">Miss Bez</p>
    </div>
  </div>

  <script>
    const noBtn = document.getElementById("noBtn");
    const yesBtn = document.getElementById("yesBtn");
    const letter = document.getElementById("letter");
    const congrats = document.getElementById("congrats");
    const buttons = document.getElementById("buttons");
    const question = document.getElementById("question");
    const card = document.querySelector(".card");
    const music = document.getElementById("bgMusic");
    const audioHint = document.getElementById("audioHint");

    let active = true;

    // Flee logic remains the same
    function flee() {
      if (!active) return;
      const padding = 20;
      const maxX = card.clientWidth - noBtn.offsetWidth - padding;
      const maxY = card.clientHeight - noBtn.offsetHeight - padding;
      const randomX = Math.max(padding, Math.random() * maxX);
      const randomY = Math.max(padding, Math.random() * maxY);
      noBtn.style.left = randomX + "px";
      noBtn.style.top = randomY + "px";
      noBtn.style.transform = "none";
      noBtn.textContent = "No üòõ";
    }

    noBtn.addEventListener("mouseover", flee);
    noBtn.addEventListener("touchstart", (e) => { e.preventDefault(); flee(); });

    // ENHANCED YES LOGIC
    yesBtn.addEventListener("click", () => {
      active = false;
      
      // 1. Try to play music
      const playPromise = music.play();

      if (playPromise !== undefined) {
        playPromise.catch(error => {
          // If autoplay is blocked, show the "Tap to play" hint
          audioHint.style.display = "block";
          // If he taps anywhere on the card now, music will play
          card.addEventListener('click', () => { 
            music.play();
            audioHint.style.display = "none";
          }, { once: true });
        });
      }

      buttons.style.display = "none";
      question.style.display = "none";
      congrats.style.display = "block";
      letter.style.display = "block";
      setInterval(createHeart, 300);
    });

    function createHeart() {
      const heart = document.createElement("div");
      heart.className = "heart";
      heart.textContent = "‚ù§Ô∏è";
      heart.style.left = Math.random() * 100 + "vw";
      heart.style.animationDuration = (Math.random() * 3 + 3) + "s";
      heart.style.fontSize = (Math.random() * 20 + 15) + "px";
      document.body.appendChild(heart);
      setTimeout(() => heart.remove(), 6000);
    }
  </script>
</body>
